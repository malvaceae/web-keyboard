<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    <title>Web Keyboard</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.min.css">
    <style>
      [v-cloak] {
        display: none;
      }

      .key {
        margin: 4px;
      }
    </style>
</head>
<body>
    <div id="app" v-cloak>
        <v-app>
            <v-content>
                <v-container fluid fill-height>
                    <v-card class="mx-auto overflow-x-auto" flat>
                        <v-row v-for="(keys, i) in keyRows" :key="`keyRows[${i}]`" class="flex-nowrap" no-gutters>
                            <v-col v-for="(key, j) in keys" :key="`keyRows[${i}][${j}]`">
                                <v-btn v-bind="key" class="key" @click="onClick(key)">
                                    <span v-html="key.html"></span>
                                </v-btn>
                            </v-col>
                        </v-row>
                    </v-card>
                </v-container>
            </v-content>
        </v-app>
    </div>
    <script src="https://cdn.jsdelivr.net/combine/npm/vue,npm/vuetify"></script>
    <script>
      new Vue({
        el: '#app',
        vuetify: new Vuetify,
        data: {
          pressingKeyCodes: [
            //
          ],
        },
        computed: {
          keyRows() {
            return [
              [
                { code:  27, width:  92, height: 48,                                                 },
                { code: 112, width:  64, height: 48,                                                 },
                { code: 113, width:  64, height: 48,                                                 },
                { code: 114, width:  64, height: 48,                                                 },
                { code: 115, width:  64, height: 48,                                                 },
                { code: 116, width:  64, height: 48,                                                 },
                { code: 117, width:  64, height: 48,                                                 },
                { code: 118, width:  64, height: 48,                                                 },
                { code: 119, width:  64, height: 48,                                                 },
                { code: 120, width:  64, height: 48,                                                 },
                { code: 121, width:  64, height: 48,                                                 },
                { code: 122, width:  64, height: 48,                                                 },
                { code: 123, width:  64, height: 48,                                                 },
                { code: 155, width:  64, height: 48,                                                 },
                { code: 127, width:  64, height: 48,                                                 },
              ],
              [
                { code: 243, width:  64, height: 64,                                                 },
                { code:  49, width:  64, height: 64,                                                 },
                { code:  50, width:  64, height: 64,                                                 },
                { code:  51, width:  64, height: 64,                                                 },
                { code:  52, width:  64, height: 64,                                                 },
                { code:  53, width:  64, height: 64,                                                 },
                { code:  54, width:  64, height: 64,                                                 },
                { code:  55, width:  64, height: 64,                                                 },
                { code:  56, width:  64, height: 64,                                                 },
                { code:  57, width:  64, height: 64,                                                 },
                { code:  48, width:  64, height: 64,                                                 },
                { code:  45, width:  64, height: 64,                                                 },
                { code: 514, width:  64, height: 64,                                                 },
                { code:  92, width:  64, height: 64,                                                 },
                { code:   8, width:  92, height: 64,                                                 },
              ],
              [
                { code:   9, width: 100, height: 64,                                                 },
                { code:  81, width:  64, height: 64,                                                 },
                { code:  87, width:  64, height: 64,                                                 },
                { code:  69, width:  64, height: 64,                                                 },
                { code:  82, width:  64, height: 64,                                                 },
                { code:  84, width:  64, height: 64,                                                 },
                { code:  89, width:  64, height: 64,                                                 },
                { code:  85, width:  64, height: 64,                                                 },
                { code:  73, width:  64, height: 64,                                                 },
                { code:  79, width:  64, height: 64,                                                 },
                { code:  80, width:  64, height: 64,                                                 },
                { code: 512, width:  64, height: 64,                                                 },
                { code:  91, width:  64, height: 64,                                                 },
                { code:  10, width: 128, height: 64,                                                 },
              ],
              [
                { code:  20, width: 128, height: 64,                                                 },
                { code:  65, width:  64, height: 64,                                                 },
                { code:  83, width:  64, height: 64,                                                 },
                { code:  68, width:  64, height: 64,                                                 },
                { code:  70, width:  64, height: 64,                                                 },
                { code:  71, width:  64, height: 64,                                                 },
                { code:  72, width:  64, height: 64,                                                 },
                { code:  74, width:  64, height: 64,                                                 },
                { code:  75, width:  64, height: 64,                                                 },
                { code:  76, width:  64, height: 64,                                                 },
                { code:  59, width:  64, height: 64,                                                 },
                { code: 513, width:  64, height: 64,                                                 },
                { code:  93, width:  64, height: 64,                                                 },
                { code:  10, width: 100, height: 64,                                                 },
              ],
              [
                { code:  16, width: 164, height: 64, inputValue: this.pressingKeyCodes.includes( 16) },
                { code:  90, width:  64, height: 64,                                                 },
                { code:  88, width:  64, height: 64,                                                 },
                { code:  67, width:  64, height: 64,                                                 },
                { code:  86, width:  64, height: 64,                                                 },
                { code:  66, width:  64, height: 64,                                                 },
                { code:  78, width:  64, height: 64,                                                 },
                { code:  77, width:  64, height: 64,                                                 },
                { code:  44, width:  64, height: 64,                                                 },
                { code:  46, width:  64, height: 64,                                                 },
                { code:  47, width:  64, height: 64,                                                 },
                { code: 523, width:  64, height: 64,                                                 },
                { code:  38, width:  64, height: 64,                                                 },
                { code:  16, width:  64, height: 64, inputValue: this.pressingKeyCodes.includes( 16) },
              ],
              [
                { code:  17, width:  92, height: 64, inputValue: this.pressingKeyCodes.includes( 17) },
                { code: 524, width:  64, height: 64, inputValue: this.pressingKeyCodes.includes(524) },
                { code: 524, width:  64, height: 64,                                                 },
                { code:  18, width:  64, height: 64, inputValue: this.pressingKeyCodes.includes( 18) },
                { code:  29, width:  64, height: 64,                                                 },
                { code:  32, width: 208, height: 64,                                                 },
                { code:  28, width:  64, height: 64,                                                 },
                { code:  18, width:  64, height: 64, inputValue: this.pressingKeyCodes.includes( 18) },
                { code: 525, width:  64, height: 64,                                                 },
                { code:  17, width:  64, height: 64, inputValue: this.pressingKeyCodes.includes( 17) },
                { code:  37, width:  64, height: 64,                                                 },
                { code:  40, width:  64, height: 64,                                                 },
                { code:  39, width:  64, height: 64,                                                 },
              ],
            ];
          },
        },
        methods: {
          async onClick({ code, inputValue }) {
            if (inputValue === undefined) {
              await this.sendKeyCode(code);
              return;
            }

            if (inputValue) {
              this.pressingKeyCodes = this.pressingKeyCodes.filter(_ => !(_ === code));
            } else {
              this.pressingKeyCodes = this.pressingKeyCodes.concat(code);
            }
          },
          async sendKeyCode(code) {
            const body = this.pressingKeyCodes.concat(code).join('\n');

            await fetch('/api', {
              method: 'PUT',
              body,
            });
          },
        },
      });
    </script>
</body>
</html>
